<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Curadoria de Documento</title>
    <link rel="stylesheet" href="https://maxst.icons8.com/vue-static/landings/line-awesome/line-awesome/1.3.0/css/line-awesome.min.css">
    <link rel="stylesheet" href="/static/css/output.css">
</head>
<body class="bg-gray-50">

    <div class="min-h-screen py-8 px-4">

        <div class="text-center mb-12">
            <div class="mb-6">
                <i class="las la-file-contract text-6xl text-primary "></i>
                <h1 class="text-4xl font-bold text-gray-900 mb-2">Curadoria de Documento</h1>
                <p class="text-xl text-gray-600">T.R. Gerado - Termo de Referência</p>
                {% if projeto %}
                    <p class="text-lg text-gray-500 mt-2">Projeto: {{ projeto.nome }}</p>
                {% endif %}
            </div>
        </div>

        {% if not tr %}
        <div class="max-w-4xl mx-auto mb-6">
            <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                <div class="flex items-center">
                    <i class="las la-exclamation-triangle text-yellow-600 text-2xl mr-3"></i>
                    <p class="text-yellow-800">Nenhum TR encontrado para este projeto.</p>
                </div>
            </div>
        </div>
        {% endif %}

        <div class="max-w-4xl mx-auto space-y-6">

            <div class="bg-white border border-gray-200 rounded-lg shadow-sm">
                <h3 class="p-6 text-xl font-semibold text-gray-900 border-b border-gray-200 ">Informações Básicas</h3>
                <div class="p-6 space-y-4">
                    <div>
                        <div class="flex justify-between items-start mb-3">
                            <div class="flex items-center">
                                <i class="las la-building text-2xl text-gray-600 mr-3"></i>
                                <label class="text-lg font-medium text-gray-900">Órgão Contratante</label>
                            </div>
                            <button type="button" class="edit-btn btn-outlined" data-target="orgao-contratante"><i class="las la-edit mr-1"></i>Editar</button>
                        </div>
                        <input type="text" id="orgao-contratante" class="editable-content block w-full p-3 text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-primary focus:border-primary" value="{% if tr %}{{ tr.orgao_contratante or '' }}{% endif %}" disabled>
                    </div>
                    <div>
                        <div class="flex justify-between items-start mb-3">
                            <div class="flex items-center">
                                <i class="las la-cogs text-2xl text-gray-600 mr-3"></i>
                                <label class="text-lg font-medium text-gray-900">Tipo de Contratação</label>
                            </div>
                             <!-- No edit button for radio buttons -->
                        </div>
                        <div id="tipo-contratacao" class="editable-content flex space-x-6 items-center">
                            <div class="flex items-center">
                                <input id="tipo-compras" type="radio" value="compras" name="tipo-contratacao" class="w-4 h-4 text-primary bg-gray-100 border-gray-300 focus:ring-primary focus:ring-2" {% if tr and tr.tipo_contratacao == 'compras' %}checked{% endif %} disabled>
                                <label for="tipo-compras" class="ml-2 block text-sm font-medium text-gray-900">Compras</label>
                            </div>
                            <div class="flex items-center">
                                <input id="tipo-servicos" type="radio" value="servicos" name="tipo-contratacao" class="w-4 h-4 text-primary bg-gray-100 border-gray-300 focus:ring-primary focus:ring-2" {% if tr and tr.tipo_contratacao == 'servicos' %}checked{% endif %} disabled>
                                <label for="tipo-servicos" class="ml-2 block text-sm font-medium text-gray-900">Serviços</label>
                            </div>
                        </div>
                    </div>
                    <div>
                        <div class="flex justify-between items-start mb-3">
                            <div class="flex items-center">
                                <i class="las la-clipboard-list text-2xl text-gray-600 mr-3"></i>
                                <label class="text-lg font-medium text-gray-900">Objeto da Contratação</label>
                            </div>
                            <button type="button" class="edit-btn btn-outlined" data-target="objeto-contratacao"><i class="las la-edit mr-1"></i>Editar</button>
                        </div>
                         <textarea id="objeto-contratacao" class="editable-content block w-full p-3 text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 border-gray-300 resize-none focus:ring-primary focus:border-primary" rows="4" disabled>{% if tr %}{{ tr.objeto_contratacao or '' }}{% endif %}</textarea>
                    </div>
                    <div>
                        <div class="flex justify-between items-start mb-3">
                            <div class="flex items-center">
                                <i class="las la-lightbulb text-2xl text-gray-600 mr-3"></i>
                                <label class="text-lg font-medium text-gray-900">Descrição da Solução</label>
                            </div>
                            <button type="button" class="edit-btn btn-outlined" data-target="descricao-solucao"><i class="las la-edit mr-1"></i>Editar</button>
                        </div>
                        <textarea id="descricao-solucao" class="editable-content block w-full p-3 text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 resize-none focus:ring-primary focus:border-primary" rows="5" disabled>{% if tr %}{{ tr.descricao_solucao or '' }}{% endif %}</textarea>
                    </div>
                    <div>
                        <div class="flex justify-between items-start mb-3">
                            <div class="flex items-center">
                                <i class="las la-gavel text-2xl text-gray-600 mr-3"></i>
                                <label class="text-lg font-medium text-gray-900">Modalidade de Licitação</label>
                            </div>
                            <!-- No edit button for radio buttons -->
                        </div>
                        <div id="modalidade-licitacao" class="editable-content flex space-x-6 items-center">
                            <div class="flex items-center">
                                <input id="modalidade-aquisicao-direta" type="radio" value="aquisicao_direta" name="modalidade-licitacao" class="w-4 h-4 text-primary bg-gray-100 border-gray-300 focus:ring-primary focus:ring-2" {% if tr and tr.modalidade_licitacao == 'aquisicao_direta' %}checked{% endif %} disabled>
                                <label for="modalidade-aquisicao-direta" class="ml-2 block text-sm font-medium text-gray-900">Aquisição direta</label>
                            </div>
                            <div class="flex items-center">
                                <input id="modalidade-registro-precos" type="radio" value="registro_precos" name="modalidade-licitacao" class="w-4 h-4 text-primary bg-gray-100 border-gray-300 focus:ring-primary focus:ring-2" {% if tr and tr.modalidade_licitacao == 'registro_precos' %}checked{% endif %} disabled>
                                <label for="modalidade-registro-precos" class="ml-2 block text-sm font-medium text-gray-900">Registro de preços</label>
                            </div>
                        </div>
                    </div>
                    
                    {% if tr.fundamentacao_legal %}
                    <div>
                        <div class="flex justify-between items-start mb-3">
                            <div class="flex items-center">
                                <i class="las la-balance-scale text-2xl text-gray-600 mr-3"></i>
                                <label class="text-lg font-medium text-gray-900">Fundamentação Legal</label>
                            </div>
                            <button type="button" class="edit-btn btn-outlined" data-target="fundamentacao-legal"><i class="las la-edit mr-1"></i>Editar</button>
                        </div>
                        <textarea id="fundamentacao-legal" class="editable-content block w-full p-3 text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 border-gray-300 resize-none focus:ring-primary focus:border-primary" rows="3" disabled>{% if tr %}{{ tr.fundamentacao_legal or '' }}{% endif %}</textarea>
                    </div>
                    {% endif %} 
                </div>
            </div>

            <div class="bg-white border border-gray-200 rounded-lg shadow-sm">
                <h3 class="p-6 text-xl font-semibold text-gray-900 border-b border-gray-200 ">Requisitos da Contratação</h3>
                <div class="p-6 space-y-4">
                    <div>
                        <div class="flex justify-between items-start mb-3">
                            <div class="flex items-center"><i class="las la-leaf text-2xl text-gray-600 mr-3"></i><label class="text-lg font-medium text-gray-900">Sustentabilidade</label></div>
                            <button type="button" class="edit-btn btn-outlined" data-target="sustentabilidade"><i class="las la-edit mr-1"></i>Editar</button>
                        </div>
                        <textarea id="sustentabilidade" class="editable-content block w-full p-3 text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 resize-none focus:ring-primary focus:border-primary" rows="3" disabled>{% if tr and tr.requisitos_contratacao %}{{ tr.requisitos_contratacao.sustentabilidade or '' }}{% endif %}</textarea>
                    </div>
                    <div>
                        <div class="flex justify-between items-start mb-3">
                            <div class="flex items-center"><i class="las la-tag text-2xl text-gray-600 mr-3"></i><label class="text-lg font-medium text-gray-900">Indicação de Marcas</label></div>
                            <button type="button" class="edit-btn btn-outlined" data-target="indicacao-marcas"><i class="las la-edit mr-1"></i>Editar</button>
                        </div>
                        <textarea id="indicacao-marcas" class="editable-content block w-full p-3 text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 resize-none focus:ring-primary focus:border-primary" rows="3" disabled>{% if tr and tr.requisitos_contratacao %}{{ tr.requisitos_contratacao.indicacao_marcas or '' }}{% endif %}</textarea>
                    </div>
                    <div>
                        <div class="flex justify-between items-start mb-3">
                            <div class="flex items-center"><i class="las la-ban text-2xl text-gray-600 mr-3"></i><label class="text-lg font-medium text-gray-900">Vedação de Marca/Produto</label></div>
                            <button type="button" class="edit-btn btn-outlined" data-target="vedacao-marca-produto"><i class="las la-edit mr-1"></i>Editar</button>
                        </div>
                        <textarea id="vedacao-marca-produto" class="editable-content block w-full p-3 text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 resize-none focus:ring-primary focus:border-primary" rows="3" disabled>{% if tr and tr.requisitos_contratacao %}{{ tr.requisitos_contratacao.vedacao_marca_produto or '' }}{% endif %}</textarea>
                    </div>
                     <div>
                        <div class="flex justify-between items-start mb-3">
                            <div class="flex items-center"><i class="las la-tools text-2xl text-gray-600 mr-3"></i><label class="text-lg font-medium text-gray-900">Garantia do Produto/Serviço</label></div>
                            <button type="button" class="edit-btn btn-outlined" data-target="garantia-produto-servico"><i class="las la-edit mr-1"></i>Editar</button>
                        </div>
                        <textarea id="garantia-produto-servico" class="editable-content block w-full p-3 text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 resize-none focus:ring-primary focus:border-primary" rows="3" disabled>{% if tr and tr.requisitos_contratacao %}{{ tr.requisitos_contratacao.garantia_produto_servico or '' }}{% endif %}</textarea>
                    </div>
                    <div class="flex items-center gap-4">
                        <div class="flex items-center"><input type="checkbox" id="exige-amostra" value="" class="w-4 h-4 text-primary bg-gray-100 border-gray-300 rounded focus:ring-primary dark:focus:ring-primary dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600" {% if tr and tr.requisitos_contratacao and tr.requisitos_contratacao.exige_amostra %}checked{% endif %}><label for="exige-amostra" class="ms-2 text-sm font-medium text-gray-900 dark:text-gray-300">Exige Amostra</label></div>
                        <div class="flex items-center"><input type="checkbox" id="exige-carta-solidariedade" value="" class="w-4 h-4 text-primary bg-gray-100 border-gray-300 rounded focus:ring-primary dark:focus:ring-primary dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600" {% if tr and tr.requisitos_contratacao and tr.requisitos_contratacao.exige_carta_solidariedade %}checked{% endif %}><label for="exige-carta-solidariedade" class="ms-2 text-sm font-medium text-gray-900 dark:text-gray-300">Exige Carta de Solidariedade</label></div>
                        <div class="flex items-center"><input type="checkbox" id="exige-vistoria" value="" class="w-4 h-4 text-primary bg-gray-100 border-gray-300 rounded focus:ring-primary dark:focus:ring-primary dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600" {% if tr and tr.requisitos_contratacao and tr.requisitos_contratacao.exige_vistoria %}checked{% endif %}><label for="exige-vistoria" class="ms-2 text-sm font-medium text-gray-900 dark:text-gray-300">Exige Vistoria</label></div>
                        <div class="flex items-center">
                            <input type="checkbox" id="admite-subcontratacao" value="" class="w-4 h-4 text-primary bg-gray-100 border-gray-300 rounded focus:ring-primary dark:focus:ring-primary dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600" {% if tr and tr.admite_subcontratacao %}checked{% endif %}>
                            <label for="admite-subcontratacao" class="ms-2 text-sm font-medium text-gray-900 dark:text-gray-300">Admite Subcontratação</label>
                        </div>
                        <div class="flex items-center">
                            <input type="checkbox" id="exige-garantia" value="" class="w-4 h-4 text-primary bg-gray-100 border-gray-300 rounded focus:ring-primary dark:focus:ring-primary dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600" {% if tr and tr.exige_garantia_contratual %}checked{% endif %}>
                            <label for="exige-garantia" class="ms-2 text-sm font-medium text-gray-900 dark:text-gray-300">Exige Garantia Contratual</label>
                        </div>
                    </div>
                </div>
            </div>

            <div class="bg-white border border-gray-200 rounded-lg shadow-sm">
                <h3 class="p-6 text-xl font-semibold text-gray-900 border-b border-gray-200 ">Modelo de Execução</h3>
                <div class="p-6 space-y-4">
                    <div>
                        <div class="flex justify-between items-start mb-3">
                            <div class="flex items-center"><i class="las la-truck text-2xl text-gray-600 mr-3"></i><label class="text-lg font-medium text-gray-900">Condições de Entrega</label></div>
                            <button type="button" class="edit-btn btn-outlined" data-target="condicoes-entrega"><i class="las la-edit mr-1"></i>Editar</button>
                        </div>
                        <textarea id="condicoes-entrega" class="editable-content block w-full p-3 text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 resize-none focus:ring-primary focus:border-primary" rows="3" disabled>{% if tr and tr.modelo_execucao %}{{ tr.modelo_execucao.condicoes_entrega or '' }}{% endif %}</textarea>
                    </div>
                    <div>
                        <div class="flex justify-between items-start mb-3">
                            <div class="flex items-center"><i class="las la-file-alt text-2xl text-gray-600 mr-3"></i><label class="text-lg font-medium text-gray-900">Condições da Execução</label></div>
                            <button type="button" class="edit-btn btn-outlined" data-target="condicoes-execucao"><i class="las la-edit mr-1"></i>Editar</button>
                        </div>
                        <textarea id="condicoes-execucao" class="editable-content block w-full p-3 text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 resize-none focus:ring-primary focus:border-primary" rows="3" disabled>{% if tr and tr.modelo_execucao %}{{ tr.modelo_execucao.condicoes_execucao or '' }}{% endif %}</textarea>
                    </div>
                    <div>
                        <div class="flex justify-between items-start mb-3">
                            <div class="flex items-center"><i class="las la-box-open text-2xl text-gray-600 mr-3"></i><label class="text-lg font-medium text-gray-900">Materiais a serem disponibilizados pela Contratada</label></div>
                            <button type="button" class="edit-btn btn-outlined" data-target="materiais-disponibilizados"><i class="las la-edit mr-1"></i>Editar</button>
                        </div>
                        <textarea id="materiais-disponibilizados" class="editable-content block w-full p-3 text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 resize-none focus:ring-primary focus:border-primary" rows="3" disabled>{% if tr and tr.modelo_execucao %}{{ tr.modelo_execucao.materiais_disponibilizados or '' }}{% endif %}</textarea>
                    </div>
                    <div>
                        <div class="flex justify-between items-start mb-3">
                            <div class="flex items-center"><i class="las la-info-circle text-2xl text-gray-600 mr-3"></i><label class="text-lg font-medium text-gray-900">Informações Relevantes</label></div>
                            <button type="button" class="edit-btn btn-outlined" data-target="informacoes-relevantes"><i class="las la-edit mr-1"></i>Editar</button>
                        </div>
                        <textarea id="informacoes-relevantes" class="editable-content block w-full p-3 text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 resize-none focus:ring-primary focus:border-primary" rows="3" disabled>{% if tr and tr.modelo_execucao %}{{ tr.modelo_execucao.informacoes_relevantes or '' }}{% endif %}</textarea>
                    </div>
                    <div>
                        <div class="flex justify-between items-start mb-3">
                            <div class="flex items-center"><i class="las la-headset text-2xl text-gray-600 mr-3"></i><label class="text-lg font-medium text-gray-900">Garantia e Manutenção (Assistência Técnica)</label></div>
                            <button type="button" class="edit-btn btn-outlined" data-target="garantia-manutencao"><i class="las la-edit mr-1"></i>Editar</button>
                        </div>
                        <textarea id="garantia-manutencao" class="editable-content block w-full p-3 text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 resize-none focus:ring-primary focus:border-primary" rows="3" disabled>{% if tr and tr.modelo_execucao %}{{ tr.modelo_execucao.garantia_manutencao or '' }}{% endif %}</textarea>
                    </div>
                </div>
            </div>

            <div class="bg-white border border-gray-200 rounded-lg shadow-sm">
                <h3 class="p-6 text-xl font-semibold text-gray-900 border-b border-gray-200 ">Prazos e Local</h3>
                <div class="p-6 space-y-4">
                    <div>
                        <div class="flex justify-between items-start mb-3">
                            <div class="flex items-center"><i class="las la-clock text-2xl text-gray-600 mr-3"></i><label class="text-lg font-medium text-gray-900">Prazo de Vigência do Contrato</label></div>
                            <button type="button" class="edit-btn btn-outlined" data-target="prazo-vigencia"><i class="las la-edit mr-1"></i>Editar</button>
                        </div>
                        <input type="text" id="prazo-vigencia" class="editable-content block w-full p-3 text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-primary focus:border-primary" value="{% if tr %}{{ tr.prazo_vigencia_contrato or '' }}{% endif %}" disabled>
                    </div>
                    <div>
                        <div class="flex justify-between items-start mb-3">
                            <div class="flex items-center"><i class="las la-calendar text-2xl text-gray-600 mr-3"></i><label class="text-lg font-medium text-gray-900">Prazo de Entrega/Prestação</label></div>
                            <button type="button" class="edit-btn btn-outlined" data-target="prazo-entrega"><i class="las la-edit mr-1"></i>Editar</button>
                        </div>
                        <input type="text" id="prazo-entrega" class="editable-content block w-full p-3 text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-primary focus:border-primary" value="{% if tr %}{{ tr.prazo_entrega_prestacao or '' }}{% endif %}" disabled>
                    </div>
                    <div>
                        <div class="flex justify-between items-start mb-3">
                            <div class="flex items-center"><i class="las la-map-marker-alt text-2xl text-gray-600 mr-3"></i><label class="text-lg font-medium text-gray-900">Local de Entrega/Prestação</label></div>
                            <button type="button" class="edit-btn btn-outlined" data-target="local-entrega"><i class="las la-edit mr-1"></i>Editar</button>
                        </div>
                        <textarea id="local-entrega" class="editable-content block w-full p-3 text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 resize-none focus:ring-primary focus:border-primary" rows="2" disabled>{% if tr %}{{ tr.local_entrega_prestacao or '' }}{% endif %}</textarea>
                    </div>
                </div>
            </div>

            <div class="bg-white border border-gray-200 rounded-lg shadow-sm">
                <h3 class="p-6 text-xl font-semibold text-gray-900 border-b border-gray-200 ">Obrigações</h3>
                <div class="p-6 space-y-4">
                    <!-- Obrigações do Contratante -->
                    <div>
                        <div class="flex justify-between items-center mb-2">
                            <div class="flex items-center"><i class="las la-handshake text-2xl text-gray-600 mr-3"></i><label class="text-lg font-medium text-gray-900">Obrigações do Contratante</label></div>
                            <button id="add-obrigacao-contratante-btn" type="button" class="btn-primary px-3 py-1.5"><i class="las la-plus mr-1"></i>Adicionar</button>
                        </div>
                        <div id="obrigacoes-contratante-container" class="space-y-2">
                            {% if tr and tr.obrigacoes_contratante %}
                                {% for item in tr.obrigacoes_contratante %}
                                <div class="flex items-center gap-3 p-2 border border-gray-200 rounded-md obrigacao-row">
                                    <input type="text" value="{{ item }}" class="flex-grow p-2 border-gray-300 focus:border-primary focus:ring-primary border rounded-md obrigacao-input">
                                    <button type="button" class="text-red-500 hover:text-red-700 remove-obrigacao-btn"><i class="las la-trash-alt text-xl"></i></button>
                                </div>
                                {% endfor %}
                            {% endif %}
                        </div>
                    </div>

                    <!-- Obrigações da Contratada -->
                    <div>
                        <div class="flex justify-between items-center mb-2">
                            <div class="flex items-center"><i class="las la-handshake text-2xl text-gray-600 mr-3"></i><label class="text-lg font-medium text-gray-900">Obrigações da Contratada</label></div>
                            <button id="add-obrigacao-contratada-btn" type="button" class="btn-primary px-3 py-1.5"><i class="las la-plus mr-1"></i>Adicionar</button>
                        </div>
                        <div id="obrigacoes-contratada-container" class="space-y-2">
                            {% if tr and tr.obrigacoes_contratada %}
                                {% for item in tr.obrigacoes_contratada %}
                                <div class="flex items-center gap-3 p-2 border border-gray-200 rounded-md obrigacao-row">
                                    <input type="text" value="{{ item }}" class="flex-grow p-2 border-gray-300 focus:border-primary focus:ring-primary border rounded-md obrigacao-input">
                                    <button type="button" class="text-red-500 hover:text-red-700 remove-obrigacao-btn"><i class="las la-trash-alt text-xl"></i></button>
                                </div>
                                {% endfor %}
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>

            <div class="bg-white border border-gray-200 rounded-lg shadow-sm">
                <h3 class="p-6 text-xl font-semibold text-gray-900 border-b border-gray-200 ">Gestão e Fiscalização do Contrato</h3>
                <div class="p-6 space-y-4">
                    <div>
                        <div class="flex justify-between items-start mb-3">
                            <div class="flex items-center"><i class="las la-user-check text-2xl text-gray-600 mr-3"></i><label class="text-lg font-medium text-gray-900">Modelo de Gestão</label></div>
                            <button type="button" class="edit-btn btn-outlined" data-target="modelo-gestao"><i class="las la-edit mr-1"></i>Editar</button>
                        </div>
                        <textarea id="modelo-gestao" class="editable-content block w-full p-3 text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 resize-none focus:ring-primary focus:border-primary" rows="3" disabled>{% if tr and tr.gestao_contrato %}{{ tr.gestao_contrato.modelo_gestao or '' }}{% endif %}</textarea>
                    </div>
                    <div>
                        <div class="flex justify-between items-start mb-3">
                            <div class="flex items-center"><i class="las la-users-cog text-2xl text-gray-600 mr-3"></i><label class="text-lg font-medium text-gray-900">Papéis e Responsabilidades (Gestor e Fiscal)</label></div>
                            <button type="button" class="edit-btn btn-outlined" data-target="papeis-responsabilidades"><i class="las la-edit mr-1"></i>Editar</button>
                        </div>
                        <textarea id="papeis-responsabilidades" class="editable-content block w-full p-3 text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 resize-none focus:ring-primary focus:border-primary" rows="4" disabled>{% if tr and tr.gestao_contrato %}{{ tr.gestao_contrato.papeis_responsabilidades or '' }}{% endif %}</textarea>
                    </div>
                </div>
            </div>

            <div class="bg-white border border-gray-200 rounded-lg shadow-sm">
                <h3 class="p-6 text-xl font-semibold text-gray-900 border-b border-gray-200 ">Critérios de Pagamento</h3>
                <div class="p-6 space-y-4">
                     <div>
                        <div class="flex justify-between items-start mb-3">
                            <div class="flex items-center"><i class="las la-credit-card text-2xl text-gray-600 mr-3"></i><label class="text-lg font-medium text-gray-900">Condições de Pagamento</label></div>
                             <button type="button" class="edit-btn btn-outlined" data-target="condicoes-pagamento"><i class="las la-edit mr-1"></i>Editar</button>
                        </div>
                        <textarea id="condicoes-pagamento" class="editable-content block w-full p-3 text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 resize-none focus:ring-primary focus:border-primary" rows="3" disabled>{% if tr %}{{ tr.condicoes_pagamento or '' }}{% endif %}</textarea>
                    </div>
                    <div>
                        <div class="flex justify-between items-start mb-3">
                            <div class="flex items-center"><i class="las la-box-open text-2xl text-gray-600 mr-3"></i><label class="text-lg font-medium text-gray-900">Recebimento do Objeto</label></div>
                            <button type="button" class="edit-btn btn-outlined" data-target="recebimento-objeto"><i class="las la-edit mr-1"></i>Editar</button>
                        </div>
                        <textarea id="recebimento-objeto" class="editable-content block w-full p-3 text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 resize-none focus:ring-primary focus:border-primary" rows="3" disabled>{% if tr and tr.criterios_pagamento %}{{ tr.criterios_pagamento.recebimento_objeto or '' }}{% endif %}</textarea>
                    </div>
                    <div>
                        <div class="flex justify-between items-start mb-3">
                            <div class="flex items-center">
                                <i class="las la-tasks text-2xl text-gray-600 mr-3"></i>
                                <label class="text-lg font-medium text-gray-900">Instrumento a ser utilizado para avaliação da execução do objeto</label>
                            </div>
                        </div>
                        {% set avaliacao = tr.criterios_pagamento.avaliacao if tr and tr.criterios_pagamento and tr.criterios_pagamento.avaliacao else None %}
                        <div id="avaliacao-group" class="space-y-3">
                            <div class="flex items-center">
                                <input id="avaliacao-opcao-1" name="avaliacao-opcao" type="radio" class="h-4 w-4 border-gray-300 text-primary focus:ring-primary" value="instrumento_medicao_resultado" {% if not avaliacao or not avaliacao.criterio or avaliacao.criterio == 'instrumento_medicao_resultado' %}checked{% endif %}>
                                <label for="avaliacao-opcao-1" class="ml-3 flex-1">
                                    <input type="text" name="avaliacao_anexo" class="block w-full p-3 text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-primary focus:border-primary" value="{{ avaliacao.anexo if avaliacao and avaliacao.anexo else 'o Instrumento de Medição de Resultado (IMR), conforme previsto no Anexo [INSERIR NÚMERO E NOME DO ANEXO]' }}">
                                </label>
                            </div>
                            <div class="flex items-center">
                                <input id="avaliacao-opcao-2" name="avaliacao-opcao" type="radio" class="h-4 w-4 border-gray-300 text-primary focus:ring-primary" value="outro_instrumento" {% if avaliacao and avaliacao.criterio == 'outro_instrumento' %}checked{% endif %}>
                                <label for="avaliacao-opcao-2" class="ml-3 flex-1">
                                    <input type="text" name="avaliacao_instrumento" class="block w-full p-3 text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-primary focus:border-primary" value="{{ avaliacao.instrumento if avaliacao and avaliacao.instrumento else 'outro instrumento substituto para aferição da qualidade da prestação dos serviços: [DESCREVER INSTRUMENTO]' }}">
                                </label>
                            </div>
                            <div class="flex items-center">
                                <input id="avaliacao-opcao-3" name="avaliacao-opcao" type="radio" class="h-4 w-4 border-gray-300 text-primary focus:ring-primary" value="disposto_item" {% if avaliacao and avaliacao.criterio == 'disposto_item' %}checked{% endif %}>
                                <label for="avaliacao-opcao-3" class="ml-3 flex-1">
                                    <input type="text" name="avaliacao_descricao_item" class="block w-full p-3 text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-primary focus:border-primary" value="{{ avaliacao.descricao_item if avaliacao and avaliacao.descricao_item else 'o disposto neste item: [DESCREVER ITEM]' }}">
                                </label>
                            </div>
                        </div>
                    </div>
                    <div>
                        <div class="flex justify-between items-start mb-3">
                            <div class="flex items-center"><i class="las la-file-invoice-dollar text-2xl text-gray-600 mr-3"></i><label class="text-lg font-medium text-gray-900">Liquidação</label></div>
                            <button type="button" class="edit-btn btn-outlined" data-target="liquidacao"><i class="las la-edit mr-1"></i>Editar</button>
                        </div>
                        <textarea id="liquidacao" class="editable-content block w-full p-3 text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 resize-none focus:ring-primary focus:border-primary" rows="3" disabled>{% if tr and tr.criterios_pagamento %}{{ tr.criterios_pagamento.liquidacao or '' }}{% endif %}</textarea>
                    </div>
                    <div>
                        <div class="flex justify-between items-start mb-3">
                             <div class="flex items-center"><i class="las la-calendar-check text-2xl text-gray-600 mr-3"></i><label class="text-lg font-medium text-gray-900">Prazo de Pagamento</label></div>
                            <button type="button" class="edit-btn btn-outlined" data-target="prazo-pagamento"><i class="las la-edit mr-1"></i>Editar</button>
                        </div>
                        <input type="text" id="prazo-pagamento" class="editable-content block w-full p-3 text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-primary focus:border-primary" value="{% if tr and tr.criterios_pagamento %}{{ tr.criterios_pagamento.prazo_pagamento or '' }}{% endif %}" disabled>
                    </div>
                    <div>
                        <div class="flex justify-between items-start mb-3">
                            <div class="flex items-center"><i class="las la-money-bill-wave text-2xl text-gray-600 mr-3"></i><label class="text-lg font-medium text-gray-900">Forma de Pagamento</label></div>
                            <button type="button" class="edit-btn btn-outlined" data-target="forma-pagamento"><i class="las la-edit mr-1"></i>Editar</button>
                        </div>
                        <input type="text" id="forma-pagamento" class="editable-content block w-full p-3 text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-primary focus:border-primary" value="{% if tr and tr.criterios_pagamento %}{{ tr.criterios_pagamento.forma_pagamento or '' }}{% endif %}" disabled>
                    </div>
                </div>

                <div class="p-6">
                    <div class="flex justify-between items-start mb-3">
                        <div class="flex items-center">
                            <i class="las la-money-bill-wave text-2xl text-gray-600 mr-3"></i>
                            <label class="text-lg font-medium text-gray-900">Permite antecipação de pagamento?</label>
                        </div>
                    </div>
                    <div id="antecipacao-pagamento" class="editable-content flex space-x-6 items-center">
                        <div class="flex items-center">
                            <input id="permite-antecipacao" type="radio" value="true" name="antecipacao-pagamento" class="w-4 h-4 text-primary bg-gray-100 border-gray-300 focus:ring-primary focus:ring-2" {% if tr and tr.criterios_pagamento.antecipacao_pagamento == true %}checked{% endif %}>
                            <label for="permite-antecipacao" class="ml-2 block text-sm font-medium text-gray-900">Sim</label>
                        </div>
                        <div class="flex items-center">
                            <input id="nao-permite-antecipacao" type="radio" value="false" name="antecipacao-pagamento" class="w-4 h-4 text-primary bg-gray-100 border-gray-300 focus:ring-primary focus:ring-2" {% if tr and tr.criterios_pagamento.antecipacao_pagamento == false %}checked{% endif %}>
                            <label for="nao-permite-antecipacao" class="ml-2 block text-sm font-medium text-gray-900">Não</label>
                        </div>
                    </div>
                </div>
                <div class="p-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <div class="flex justify-between items-start mb-3">
                                <div class="flex items-center"><i class="las la-calendar-check text-2xl text-gray-600 mr-3"></i><label class="text-lg font-medium text-gray-900">Prazo provisório (dias)</label></div>
                                <button type="button" class="edit-btn btn-outlined" data-target="prazo-provisorio-recebimento"><i class="las la-edit mr-1"></i>Editar</button>
                            </div>
                            <input type="number" id="prazo-provisorio-recebimento" class="editable-content block w-full p-3 text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-primary focus:border-primary" value="{% if tr and tr.criterios_pagamento %}{{ tr.criterios_pagamento.prazo_provisorio_recebimento or '' }}{% endif %}" disabled>
                        </div>
                        <div>
                            <div class="flex justify-between items-start mb-3">
                                <div class="flex items-center"><i class="las la-calendar-check text-2xl text-gray-600 mr-3"></i><label class="text-lg font-medium text-gray-900">Prazo definitivo (dias)</label></div>
                                <button type="button" class="edit-btn btn-outlined" data-target="prazo-definitivo-recebimento"><i class="las la-edit mr-1"></i>Editar</button>
                            </div>
                            <input type="number" id="prazo-definitivo-recebimento" class="editable-content block w-full p-3 text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-primary focus:border-primary" value="{% if tr and tr.criterios_pagamento %}{{ tr.criterios_pagamento.prazo_definitivo_recebimento or '' }}{% endif %}" disabled>
                        </div>
                    </div>
                </div>
            </div>

            <div class="bg-white border border-gray-200 rounded-lg shadow-sm">
                <h3 class="p-6 text-xl font-semibold text-gray-900 border-b border-gray-200 ">Seleção do Fornecedor</h3>
                <div class="p-6 space-y-4">
                    <div>
                        <div class="flex justify-between items-start mb-3">
                            <div class="flex items-center"><i class="las la-tasks text-2xl text-gray-600 mr-3"></i><label class="text-lg font-medium text-gray-900">Forma de Seleção</label></div>
                            <button type="button" class="edit-btn btn-outlined" data-target="forma-selecao"><i class="las la-edit mr-1"></i>Editar</button>
                        </div>
                        <input type="text" id="forma-selecao" class="editable-content block w-full p-3 text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-primary focus:border-primary" value="{% if tr and tr.selecao_fornecedor %}{{ tr.selecao_fornecedor.forma_selecao or '' }}{% endif %}" disabled>
                    </div>
                    <div>
                        <div class="flex justify-between items-start mb-3">
                            <div class="flex items-center"><i class="las la-trophy text-2xl text-gray-600 mr-3"></i><label class="text-lg font-medium text-gray-900">Critério de Julgamento</label></div>
                            <button type="button" class="edit-btn btn-outlined" data-target="criterio-julgamento-selecao"><i class="las la-edit mr-1"></i>Editar</button>
                        </div>
                        <input type="text" id="criterio-julgamento-selecao" class="editable-content block w-full p-3 text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-primary focus:border-primary" value="{% if tr and tr.selecao_fornecedor %}{{ tr.selecao_fornecedor.criterio_julgamento or '' }}{% endif %}" disabled>
                    </div>
                    <h4 class="text-lg font-semibold text-gray-800 pt-4 border-t border-gray-300">Exigências de Habilitação</h4>
                    
                    <!-- Habilitação Jurídica -->
                    <div>
                        <div class="flex justify-between items-center mb-2">
                            <label class="text-md font-medium text-gray-900">Jurídica</label>
                            <button id="add-juridica-btn" type="button" class="btn-primary px-3 py-1.5"><i class="las la-plus mr-1"></i>Adicionar</button>
                        </div>
                        <div id="habilitacao-juridica-container" class="space-y-2">
                            {% if tr and tr.selecao_fornecedor and tr.selecao_fornecedor.exigencias_habilitacao and tr.selecao_fornecedor.exigencias_habilitacao.juridica %}
                                {% for item in tr.selecao_fornecedor.exigencias_habilitacao.juridica %}
                                <div class="flex items-center gap-3 p-2 border border-gray-200 rounded-md habilitacao-row">
                                    <input type="text" value="{{ item }}" class="flex-grow p-2 border-gray-300 focus:border-primary focus:ring-primary border rounded-md habilitacao-input">
                                    <button type="button" class="text-red-500 hover:text-red-700 remove-habilitacao-btn"><i class="las la-trash-alt text-xl"></i></button>
                                </div>
                                {% endfor %}
                            {% endif %}
                        </div>
                    </div>

                    <!-- Habilitação Fiscal e Trabalhista -->
                    <div>
                        <div class="flex justify-between items-center mb-2">
                            <label class="text-md font-medium text-gray-900">Fiscal e Trabalhista</label>
                            <button id="add-fiscal-btn" type="button" class="btn-primary px-3 py-1.5"><i class="las la-plus mr-1"></i>Adicionar</button>
                        </div>
                        <div id="habilitacao-fiscal-container" class="space-y-2">
                             {% if tr and tr.selecao_fornecedor and tr.selecao_fornecedor.exigencias_habilitacao and tr.selecao_fornecedor.exigencias_habilitacao.fiscal_trabalhista %}
                                {% for item in tr.selecao_fornecedor.exigencias_habilitacao.fiscal_trabalhista %}
                                <div class="flex items-center gap-3 p-2 border border-gray-200 rounded-md habilitacao-row">
                                    <input type="text" value="{{ item }}" class="flex-grow p-2 border-gray-300 focus:border-primary focus:ring-primary border rounded-md habilitacao-input">
                                    <button type="button" class="text-red-500 hover:text-red-700 remove-habilitacao-btn"><i class="las la-trash-alt text-xl"></i></button>
                                </div>
                                {% endfor %}
                            {% endif %}
                        </div>
                    </div>

                    <!-- Habilitação Econômico-Financeira -->
                    <div>
                        <div class="flex justify-between items-center mb-2">
                            <label class="text-md font-medium text-gray-900">Econômico-Financeira</label>
                            <button id="add-economico-btn" type="button" class="btn-primary px-3 py-1.5"><i class="las la-plus mr-1"></i>Adicionar</button>
                        </div>
                        <div id="habilitacao-economico-container" class="space-y-2">
                            {% if tr and tr.selecao_fornecedor and tr.selecao_fornecedor.exigencias_habilitacao and tr.selecao_fornecedor.exigencias_habilitacao.economico_financeira %}
                                {% for item in tr.selecao_fornecedor.exigencias_habilitacao.economico_financeira %}
                                <div class="flex items-center gap-3 p-2 border border-gray-200 rounded-md habilitacao-row">
                                    <input type="text" value="{{ item }}" class="flex-grow p-2 border-gray-300 focus:border-primary focus:ring-primary border rounded-md habilitacao-input">
                                    <button type="button" class="text-red-500 hover:text-red-700 remove-habilitacao-btn"><i class="las la-trash-alt text-xl"></i></button>
                                </div>
                                {% endfor %}
                            {% endif %}
                        </div>
                    </div>

                    <!-- Habilitação Técnica -->
                    <div>
                        <div class="flex justify-between items-center mb-2">
                            <label class="text-md font-medium text-gray-900">Técnica</label>
                            <button id="add-tecnica-btn" type="button" class="btn-primary px-3 py-1.5"><i class="las la-plus mr-1"></i>Adicionar</button>
                        </div>
                        <div id="habilitacao-tecnica-container" class="space-y-2">
                            {% if tr and tr.selecao_fornecedor and tr.selecao_fornecedor.exigencias_habilitacao and tr.selecao_fornecedor.exigencias_habilitacao.tecnica %}
                                {% for item in tr.selecao_fornecedor.exigencias_habilitacao.tecnica %}
                                <div class="flex items-center gap-3 p-2 border border-gray-200 rounded-md habilitacao-row">
                                    <input type="text" value="{{ item }}" class="flex-grow p-2 border-gray-300 focus:border-primary focus:ring-primary border rounded-md habilitacao-input">
                                    <button type="button" class="text-red-500 hover:text-red-700 remove-habilitacao-btn"><i class="las la-trash-alt text-xl"></i></button>
                                </div>
                                {% endfor %}
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="bg-white border border-gray-200 rounded-lg shadow-sm">
                <h3 class="p-6 text-xl font-semibold text-gray-900 border-b border-gray-200 ">Estimativa de Valor e Adequação Orçamentária</h3>
                <div class="p-6 space-y-4">
                     <div>
                        <div class="flex justify-between items-start mb-3">
                            <div class="flex items-center"><i class="las la-calculator text-2xl text-gray-600 mr-3"></i><label class="text-lg font-medium text-gray-900">Valor Total Estimado</label></div>
                            <button type="button" class="edit-btn btn-outlined" data-target="valor-total-estimado"><i class="las la-edit mr-1"></i>Editar</button>
                        </div>
                        <input type="number" id="valor-total-estimado" class="editable-content block w-full p-3 text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-primary focus:border-primary" value="{% if tr and tr.estimativa_valor %}{{ tr.estimativa_valor.valor_total or '' }}{% endif %}" disabled>
                    </div>
                    <div>
                        <div class="flex justify-between items-start mb-3">
                            <div class="flex items-center"><i class="las la-search-dollar text-2xl text-gray-600 mr-3"></i><label class="text-lg font-medium text-gray-900">Metodologia da Pesquisa de Preços</label></div>
                            <button type="button" class="edit-btn btn-outlined" data-target="metodologia-pesquisa"><i class="las la-edit mr-1"></i>Editar</button>
                        </div>
                        <textarea id="metodologia-pesquisa" class="editable-content block w-full p-3 text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 resize-none focus:ring-primary focus:border-primary" rows="3" disabled>{% if tr and tr.estimativa_valor %}{{ tr.estimativa_valor.metodologia_pesquisa or '' }}{% endif %}</textarea>
                    </div>
                    <div class="pt-4 border-t border-gray-200">
                        <div class="flex justify-between items-start mb-3">
                            <div class="flex items-center"><i class="las la-wallet text-2xl text-gray-600 mr-3"></i><label class="text-lg font-medium text-gray-900">Fonte de Recursos</label></div>
                             <button type="button" class="edit-btn btn-outlined" data-target="fonte-recursos"><i class="las la-edit mr-1"></i>Editar</button>
                        </div>
                        <input type="text" id="fonte-recursos" class="editable-content block w-full p-3 text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-primary focus:border-primary" value="{% if tr and tr.adequacao_orcamentaria %}{{ tr.adequacao_orcamentaria.fonte_recursos or '' }}{% endif %}" disabled>
                    </div>
                     <div>
                        <div class="flex justify-between items-start mb-3">
                            <div class="flex items-center"><i class="las la-file-alt text-2xl text-gray-600 mr-3"></i><label class="text-lg font-medium text-gray-900">Classificação Orçamentária</label></div>
                             <button type="button" class="edit-btn btn-outlined" data-target="classificacao-orcamentaria"><i class="las la-edit mr-1"></i>Editar</button>
                        </div>
                        <input type="text" id="classificacao-orcamentaria" class="editable-content block w-full p-3 text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-primary focus:border-primary" value="{% if tr and tr.adequacao_orcamentaria %}{{ tr.adequacao_orcamentaria.classificacao_orcamentaria or '' }}{% endif %}" disabled>
                    </div>
                    <div>
                        <div class="flex items-center"><input type="checkbox" id="previsao-pca" value="" class="w-4 h-4 text-primary bg-gray-100 border-gray-300 rounded focus:ring-primary dark:focus:ring-primary dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600" {% if tr and tr.adequacao_orcamentaria and tr.adequacao_orcamentaria.previsao_pca %}checked{% endif %}><label for="previsao-pca" class="ms-2 text-sm font-medium text-gray-900 dark:text-gray-300">Previsão no PCA</label></div>
                    </div>
                    <div id="codigo-pca-container" class="hidden mt-4">
                        <div class="flex justify-between items-start mb-3">
                            <div class="flex items-center"><i class="las la-barcode text-2xl text-gray-600 mr-3"></i><label for="codigo-pca" class="text-lg font-medium text-gray-900">Código PCA</label></div>
                        </div>
                        <input type="text" id="codigo-pca" class="block w-full p-3 text-sm text-gray-900 bg-white rounded-lg border border-gray-300 focus:ring-primary focus:border-primary" value="{% if tr and tr.adequacao_orcamentaria %}{{ tr.adequacao_orcamentaria.codigo_pca or '' }}{% endif %}">
                    </div>
                </div>
            </div>

            <div class="bg-white border border-gray-200 rounded-lg shadow-sm">
                <h3 class="p-6 text-xl font-semibold text-gray-900 border-b border-gray-200 ">Sistema de Registro de Preços</h3>
                <div class="p-6 space-y-4">
                    <div class="flex items-center"><input type="checkbox" id="adota-srp" value="" class="w-4 h-4 text-primary bg-gray-100 border-gray-300 rounded focus:ring-primary dark:focus:ring-primary dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600" {% if tr and tr.sistema_registro_precos and tr.sistema_registro_precos.adota_srp %}checked{% endif %}><label for="adota-srp" class="ms-2 text-sm font-medium text-gray-900 dark:text-gray-300">Adota SRP</label></div>
                    <div class="srp-fields-container space-y-4">
                        <!-- <div class="flex justify-between items-start mb-3">
                            <label class="text-lg font-medium text-gray-900">Tipo e Justificativa SRP</label>
                            <button type="button" class="edit-btn btn-outlined" data-target="srp-tipo"><i class="las la-edit mr-1"></i>Editar</button>
                        </div>
                        <div>
                            <textarea id="srp-tipo" class="editable-content block w-full p-3 text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 resize-none focus:ring-primary focus:border-primary" rows="3" disabled>{% if tr and tr.sistema_registro_precos %}{{ tr.sistema_registro_precos.tipo_srp or '' }}{% endif %}</textarea>
                        </div> -->

                        <div>
                            <label class="text-lg font-medium text-gray-900">Haverá uma quantidade máxima a ser adquirida para cada item/grupo?</label>
                            <div class="flex items-center gap-4 mt-2">
                                <div class="flex items-center">
                                    <input type="radio" id="quantidade_maxima_sim" name="quantidade_maxima" value="true" class="w-4 h-4 text-primary bg-gray-100 border-gray-300 focus:ring-primary" {% if tr and tr.sistema_registro_precos and tr.sistema_registro_precos.quantidade_maxima %}checked{% endif %}>
                                    <label for="quantidade_maxima_sim" class="ml-2 text-sm font-medium text-gray-900">Sim</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="radio" id="quantidade_maxima_nao" name="quantidade_maxima" value="false" class="w-4 h-4 text-primary bg-gray-100 border-gray-300 focus:ring-primary" {% if tr and tr.sistema_registro_precos and not tr.sistema_registro_precos.quantidade_maxima %}checked{% endif %}>
                                    <label for="quantidade_maxima_nao" class="ml-2 text-sm font-medium text-gray-900">Não</label>
                                </div>
                            </div>
                        </div>

                        <div>
                            <label for="quantidade_minima_cotacao" class="text-lg font-medium text-gray-900">Quantidade mínima a ser cotada (especifique para cada item)</label>
                            <textarea id="quantidade_minima_cotacao" class="editable-content block w-full p-3 text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 resize-none focus:ring-primary focus:border-primary mt-2" rows="3">{% if tr and tr.sistema_registro_precos %}{{ tr.sistema_registro_precos.quantidade_minima_cotacao or '' }}{% endif %}</textarea>
                        </div>

                        <div>
                            <label class="text-lg font-medium text-gray-900">Permite preços diferentes?</label>
                            <div class="flex items-center gap-4 mt-2">
                                <div class="flex items-center">
                                    <input type="radio" id="permite_precos_diferentes_sim" name="permite_precos_diferentes" value="true" class="w-4 h-4 text-primary bg-gray-100 border-gray-300 focus:ring-primary" {% if tr and tr.sistema_registro_precos and tr.sistema_registro_precos.permite_precos_diferentes %}checked{% endif %}>
                                    <label for="permite_precos_diferentes_sim" class="ml-2 text-sm font-medium text-gray-900">Sim</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="radio" id="permite_precos_diferentes_nao" name="permite_precos_diferentes" value="false" class="w-4 h-4 text-primary bg-gray-100 border-gray-300 focus:ring-primary" {% if tr and tr.sistema_registro_precos and not tr.sistema_registro_precos.permite_precos_diferentes %}checked{% endif %}>
                                    <label for="permite_precos_diferentes_nao" class="ml-2 text-sm font-medium text-gray-900">Não</label>
                                </div>
                            </div>
                        </div>

                        <div id="justificativa_precos_diferentes_container" class="{% if not tr or not tr.sistema_registro_precos or not tr.sistema_registro_precos.permite_precos_diferentes %}hidden{% endif %}">
                            <label for="justificativa_precos_diferentes" class="text-lg font-medium text-gray-900">Justificativa para preços diferentes</label>
                            <textarea id="justificativa_precos_diferentes" class="editable-content block w-full p-3 text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 resize-none focus:ring-primary focus:border-primary" rows="3">{% if tr and tr.sistema_registro_precos %}{{ tr.sistema_registro_precos.justificativa_precos_diferentes or '' }}{% endif %}</textarea>
                        </div>

                        <div>
                            <label class="text-lg font-medium text-gray-900">Permite proposta inferior?</label>
                            <div class="flex items-center gap-4 mt-2">
                                <div class="flex items-center">
                                    <input type="radio" id="permite_proposta_inferior_sim" name="permite_proposta_inferior" value="true" class="w-4 h-4 text-primary bg-gray-100 border-gray-300 focus:ring-primary" {% if tr and tr.sistema_registro_precos and tr.sistema_registro_precos.permite_proposta_inferior %}checked{% endif %}>
                                    <label for="permite_proposta_inferior_sim" class="ml-2 text-sm font-medium text-gray-900">Sim</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="radio" id="permite_proposta_inferior_nao" name="permite_proposta_inferior" value="false" class="w-4 h-4 text-primary bg-gray-100 border-gray-300 focus:ring-primary" {% if tr and tr.sistema_registro_precos and not tr.sistema_registro_precos.permite_proposta_inferior %}checked{% endif %}>
                                    <label for="permite_proposta_inferior_nao" class="ml-2 text-sm font-medium text-gray-900">Não</label>
                                </div>
                            </div>
                        </div>

                        <div>
                            <label class="text-lg font-medium text-gray-900">Registro de preços com indicação limitada a unidades de contratação</label>
                            <div class="flex items-center gap-4 mt-2">
                                <div class="flex items-center">
                                    <input type="radio" id="registro_limitado_permitido" name="registro_limitado" value="true" class="w-4 h-4 text-primary bg-gray-100 border-gray-300 focus:ring-primary" {% if tr and tr.sistema_registro_precos and tr.sistema_registro_precos.registro_limitado %}checked{% endif %}>
                                    <label for="registro_limitado_permitido" class="ml-2 text-sm font-medium text-gray-900">Permitido</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="radio" id="registro_limitado_nao_permitido" name="registro_limitado" value="false" class="w-4 h-4 text-primary bg-gray-100 border-gray-300 focus:ring-primary" {% if tr and tr.sistema_registro_precos and not tr.sistema_registro_precos.registro_limitado %}checked{% endif %}>
                                    <label for="registro_limitado_nao_permitido" class="ml-2 text-sm font-medium text-gray-900">Não permitido</label>
                                </div>
                            </div>
                        </div>

                        <div class="flex justify-between items-start mb-3">
                            <label class="text-lg font-medium text-gray-900">Prazo de Vigência da Ata</label>
                            <button type="button" class="edit-btn btn-outlined" data-target="srp-vigencia"><i class="las la-edit mr-1"></i>Editar</button>
                        </div>
                        <div>
                            <input id="srp-vigencia" type="text" class="editable-content block w-full p-3 text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-primary focus:border-primary" value="{% if tr and tr.sistema_registro_precos %}{{ tr.sistema_registro_precos.vigencia_ata or '' }}{% endif %}" disabled>
                        </div>
                        <div class="flex justify-between items-start mb-3">
                            <label class="text-lg font-medium text-gray-900">Critério de Julgamento de menor preço por:</label>
                            <button type="button" class="edit-btn btn-outlined" data-target="srp-criterio"><i class="las la-edit mr-1"></i>Editar</button>
                        </div>
                        <div>
                            <select id="srp-criterio" class="editable-content block w-full p-3 text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-primary focus:border-primary" disabled>
                                <option value="item" {% if tr and tr.sistema_registro_precos and tr.sistema_registro_precos.criterio_julgamento == 'item' %}selected{% endif %}>Item</option>
                                <option value="grupo" {% if tr and tr.sistema_registro_precos and tr.sistema_registro_precos.criterio_julgamento == 'grupo' %}selected{% endif %}>Grupo</option>
                            </select>
                        </div>
                        <div>
                            <div class="flex justify-between items-start mb-3">
                                <label class="text-lg font-medium text-gray-900">Critérios de reajuste</label>
                                <button type="button" class="edit-btn btn-outlined" data-target="criterio-reajuste"><i class="las la-edit mr-1"></i>Editar</button>
                            </div>
                            <textarea id="criterio-reajuste" class="editable-content block w-full p-3 text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 resize-none focus:ring-primary focus:border-primary" rows="3" disabled>{% if tr and tr.sistema_registro_precos %}{{ tr.sistema_registro_precos.criterio_reajuste or '' }}{% endif %}</textarea>
                        </div>
                    </div>
                </div>
            </div>

            <div class="bg-white border border-gray-200 rounded-lg shadow-sm">
                 <h3 class="p-6 text-xl font-semibold text-gray-900 border-b border-gray-200 ">Disposições Gerais</h3>
                 <div class="p-6 space-y-4">
                     <div>
                        <div class="flex justify-between items-start mb-3">
                            <div class="flex items-center"><i class="las la-gavel text-2xl text-gray-600 mr-3"></i><label class="text-lg font-medium text-gray-900">Sanções Administrativas</label></div>
                            <button type="button" class="edit-btn btn-outlined" data-target="sancoes-administrativas"><i class="las la-edit mr-1"></i>Editar</button>
                        </div>
                        <textarea id="sancoes-administrativas" class="editable-content block w-full p-3 text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 resize-none focus:ring-primary focus:border-primary" rows="3" disabled>{% if tr %}{{ tr.sancoes_administrativas or '' }}{% endif %}</textarea>
                    </div>
                 </div>
            </div>

            <div class="bg-white border border-gray-200 rounded-lg shadow-sm">
                <h3 class="p-6 text-xl font-semibold text-gray-900 border-b border-gray-200 ">Itens da Contratação</h3>
                <div class="p-6">
                    <div class="flex justify-between items-center mb-3">
                        <h2 class="text-lg font-medium text-gray-900">Itens</h2>
                        <button id="add-item-btn" type="button" class="btn-primary"><i class="las la-plus"></i>Adicionar Item</button>
                    </div>
                    <div id="items-container" class="space-y-4">
                        {% if tr and tr.itens %}
                            {% for item in tr.itens %}
                            <div class="p-4 border border-gray-200 rounded-md item-row flex items-start gap-4">
                                <div class="space-y-2 flex-grow">
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Descrição do item</label>
                                            <input type="text" value="{{ item.descricao or '' }}" placeholder="Descrição do item" class="p-2 border-gray-300 border rounded-md item-description focus:ring-primary focus:border-primary editable-content w-full">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Código CATMAT/CATSER</label>
                                            <input type="text" value="{{ item.codigo_catmat_catser or '' }}" placeholder="Código CATMAT/CATSER" class="p-2 border-gray-300 border rounded-md item-codigo focus:ring-primary focus:border-primary editable-content w-full">
                                        </div>
                                    </div>
                                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Quantidade</label>
                                            <input type="number" value="{{ item.quantidade or '' }}" placeholder="Qtd." class="p-2 border-gray-300 border rounded-md item-quantity focus:ring-primary focus:border-primary editable-content w-full" min="1" step="0.001">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Unidade de medida</label>
                                            <input type="text" value="{{ item.unidade_medida or '' }}" placeholder="Unidade" class="p-2 border-gray-300 border rounded-md item-unidade focus:ring-primary focus:border-primary editable-content w-full">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Valor Unitário</label>
                                            <input type="number" value="{{ item.valor_unitario or '' }}" placeholder="Valor Unit." class="p-2 border-gray-300 border rounded-md item-valor-unitario focus:ring-primary focus:border-primary editable-content w-full" step="0.01">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Valor Total</label>
                                            <input type="number" value="{{ item.valor_total or '' }}" placeholder="Valor Total" class="p-2 border-gray-300 border rounded-md bg-gray-100 item-valor-total w-full" disabled>
                                        </div>
                                    </div>
                                    <!-- 
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Especificações Técnicas</label>
                                        <textarea class="item-especificacoes p-2 w-full border-gray-300 border rounded-md focus:ring-primary focus:border-primary resize-none editable-content" rows="3" placeholder="Especificações Técnicas (uma por linha)">{% for spec in item.especificacoes_tecnicas %}{{ spec }}{% if not loop.last %}\n{% endif %}{% endfor %}</textarea>
                                    </div>
                                    <div class="flex justify-between items-center gap-4">
                                        <div class="flex-grow">
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Finalidade</label>
                                            <textarea class="item-finalidade w-full p-2 border-gray-300 border rounded-md focus:ring-primary focus:border-primary resize-none editable-content" rows="2" placeholder="Finalidade">{{ item.finalidade or '' }}</textarea>
                                        </div>
                                    </div>
                                    -->
                                </div>
                                <div class="pl-4">
                                    <button type="button" class="text-red-500 hover:text-red-700 remove-item-btn"><i class="las la-trash-alt text-2xl"></i></button>
                                </div>
                            </div>
                            {% endfor %}
                        {% endif %}
                    </div>
                </div>
            </div>

            <div class="bg-white border border-gray-200 rounded-lg shadow-sm">
                <h3 class="p-6 text-xl font-semibold text-gray-900 border-b border-gray-200 ">Responsável pela Elaboração</h3>
                <div class="p-6 space-y-4">
                    <div>
                        <div class="flex justify-between items-start mb-3">
                             <div class="flex items-center"><i class="las la-user-tie text-2xl text-gray-600 mr-3"></i><label class="text-lg font-medium text-gray-900">Responsável</label></div>
                            <button type="button" class="edit-btn btn-outlined" data-target="responsavel"><i class="las la-edit mr-1"></i>Editar</button>
                        </div>
                        <input type="text" id="responsavel" class="editable-content block w-full p-3 text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-primary focus:border-primary" value="{% if tr %}{{ tr.responsavel or '' }}{% endif %}" disabled>
                    </div>
                    <div>
                        <div class="flex justify-between items-start mb-3">
                             <div class="flex items-center"><i class="las la-briefcase text-2xl text-gray-600 mr-3"></i><label class="text-lg font-medium text-gray-900">Cargo do Responsável</label></div>
                            <button type="button" class="edit-btn btn-outlined" data-target="cargo-responsavel"><i class="las la-edit mr-1"></i>Editar</button>
                        </div>
                        <input type="text" id="cargo-responsavel" class="editable-content block w-full p-3 text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-primary focus:border-primary" value="{% if tr %}{{ tr.cargo_responsavel or '' }}{% endif %}" disabled>
                    </div>
                </div>
            </div>

        </div>

        <div class="max-w-4xl mx-auto mt-8 mb-8">
            <div class="flex flex-col sm:flex-row justify-center gap-4">
                <button type="button" id="salvar-alteracoes" class="btn-primary inline-flex items-center justify-center"><i class="las la-save text-lg mr-2"></i>Salvar alterações</button>
                <!-- Botão Visualizar Resultado -->
                <button type="button" id="visualizar-resultado" class="btn-outlined inline-flex items-center justify-center">
                    <i class="las la-eye text-lg mr-2"></i>
                    Visualizar resultado
                </button>
            </div>
        </div>

    </div>

    <script type="module" src="/static/js/tr/tr-curadoria.js"></script>
</body>
</html>